---
phase: 2
plan: 3
wave: 2
depends_on: [1]
files_modified:
  - "src/matriculaup/core/conflict_detector.py"
  - "src/matriculaup/ui/components/timetable_grid.py"
  - "src/matriculaup/ui/tabs/schedule_tab.py"
autonomous: true
must_haves:
  truths:
    - "Schedule grid renders blocks correctly scaled by time"
    - "Overlapping blocks are detected"
  artifacts:
    - "Timetable widget"
---

# Plan 2.3: Timetable Grid & Conflict Detection

<objective>
Implement conflict logic and the visual weekly calendar that draws selected course sections.
</objective>

<context>
Load for context:
- src/matriculaup/models/course.py
</context>

<tasks>

<task type="auto">
  <name>Conflict Detection Logic</name>
  <files>src/matriculaup/core/conflict_detector.py</files>
  <action>
    Write a pure python implementation to detect if two `Session` objects overlap in time and day.
    Parse string time %H:%M to get minutes.
    Return overlapping pairs.
  </action>
  <verify>Run a pytest unit test with two overlapping and two consecutive blocks.</verify>
  <done>Overlaps are correctly identified.</done>
</task>

<task type="auto">
  <name>Timetable Visual Grid</name>
  <files>src/matriculaup/ui/components/timetable_grid.py</files>
  <action>
    Create a custom `QWidget` that overloads `paintEvent` to draw a Monday-Friday grid from 07:30 to 23:30.
    Implement a method `render_sessions(sessions)` that draws colored blocks scaled proportionally to their duration.
  </action>
  <verify>python src/matriculaup/main.py -> second tab displays empty grid.</verify>
  <done>Grid draws 7:30-23:30 successfully with horizontal day lines.</done>
</task>

</tasks>

<verification>
After all tasks, verify:
- [ ] Overlap tests pass
- [ ] Paint event drawing is proportional to the 24-hr layout length
</verification>

<success_criteria>
- [ ] All tasks verified
- [ ] Must-haves confirmed
</success_criteria>
