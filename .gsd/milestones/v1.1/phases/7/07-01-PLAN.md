---
phase: 7
plan: 1
wave: 1
depends_on: ["Phase 6"]
files_modified: ["matriculaup_app/lib/ui/components/timetable_grid.dart", "matriculaup_app/lib/ui/pages/home_page.dart"]
autonomous: false
must_haves:
  truths:
    - "The user can switch between 'Semana Regular' and 'Semana de Exámenes' views."
    - "The Regular view hides 'FINAL' and 'PARCIAL' sessions."
    - "The Exam view only shows 'FINAL' and 'PARCIAL' sessions."
  artifacts:
    - "matriculaup_app/lib/ui/pages/home_page.dart"
---

# Plan 7.1: Advanced Views: Regular vs Exam

<objective>
Enhance the timetable to support filtered views. Students need to see their regular weekly schedule without the clutter of final/partial exams, and separately view their exam week schedules.
</objective>

<context>
Load for context:
- `matriculaup_app/lib/ui/components/timetable_grid.dart`
- `matriculaup_app/lib/ui/pages/home_page.dart`
- `matriculaup_app/lib/models/course.dart` (Check `SessionType` enum logic)
</context>

<tasks>

<task type="auto">
  <name>Implement Schedule View Toggle</name>
  <files>matriculaup_app/lib/ui/pages/home_page.dart, matriculaup_app/lib/ui/components/timetable_grid.dart</files>
  <action>
    Add a state variable (e.g., `bool showExams`) to `HomePage` or `TimetableGrid`.
    In `HomePage` (above the grid in the Flex layout), add a `ToggleButtons` or `SegmentedButton` to let the user switch between "Semana Regular" and "Exámenes".
    Pass this state to the `TimetableGrid` component.
  </action>
  <verify>Check the UI code for the SegmentedButton and state passing.</verify>
  <done>User sees a toggle control to switch views.</done>
</task>

<task type="auto">
  <name>Filter Sessions by Type</name>
  <files>matriculaup_app/lib/ui/components/timetable_grid.dart</files>
  <action>
    Modify `_buildSessionBlock` or the session iteration loop inside `TimetableGrid.build`.
    If `showExams` is false, hide any session where `session.tipo == SessionType.FINAL` or `session.tipo == SessionType.PARCIAL`.
    If `showExams` is true, ONLY show sessions where `session.tipo == SessionType.FINAL` or `session.tipo == SessionType.PARCIAL`.
  </action>
  <verify>Check the filtering logic inside the days loop.</verify>
  <done>The grid accurately filters sessions based on the current toggle state.</done>
</task>

</tasks>

<verification>
After tasks, verify:
- [ ] Changing the toggle instantly updates the blocks visible on the screen.
- [ ] Exam sessions do not appear in the Regular view, and vice versa.
</verification>

<success_criteria>
- [ ] All tasks verified
- [ ] Must-haves confirmed
</success_criteria>
